[build]
  command = "npm run build"
  # publish = ".next" # Let the plugin handle this

[[plugins]]
  package = "@netlify/plugin-nextjs"

[functions]
  # CRITICAL: Exclude Puppeteer to fit within 50MB Lambda limit
  external_node_modules = ["puppeteer", "puppeteer-core", "@sparticuz/chromium", "chrome-aws-lambda"]
  included_files = ["!node_modules/puppeteer/**", "!node_modules/puppeteer-core/**", "!node_modules/@sparticuz/chromium/**"]
